<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Les Travaux Pratiques du cours Urbanisation des Syst√®mes d'Information"><meta name=author content="Lilia Sfaxi"><link href=http://INSATunisia.github.io/TP-Urbanisation/tp3/ rel=canonical><link rel=icon href=../img/favicon.ico><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.1.10"><title>Tp3 - TP Urbanisation des Syst√®mes d'Information</title><link rel=stylesheet href=../assets/stylesheets/main.d6be258b.min.css><link rel=stylesheet href=../assets/stylesheets/palette.e6a45f82.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Questrial:300,400,400i,700%7CSource+Code+Pro&display=fallback"><style>:root{--md-text-font:"Questrial";--md-code-font:"Source Code Pro"}</style><link rel=stylesheet href=../css/timeago.css><link rel=stylesheet href=../stylesheets/extra.css><link rel=stylesheet href=../stylesheets/links.css><link rel=stylesheet href=../stylesheets/custom.css><script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=amber data-md-color-accent=amber> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#telecharger-pdf class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="TP Urbanisation des Syst√®mes d'Information" class="md-header__button md-logo" aria-label="TP Urbanisation des Syst√®mes d'Information" data-md-component=logo> <img src=../img/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> TP Urbanisation des Syst√®mes d'Information </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Tp3 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=amber data-md-color-accent=amber aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=amber data-md-color-accent=amber aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/INSATunisia/TP-Urbanisation/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> INSATunisia/TP-Urbanisation </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="TP Urbanisation des Syst√®mes d'Information" class="md-nav__button md-logo" aria-label="TP Urbanisation des Syst√®mes d'Information" data-md-component=logo> <img src=../img/logo.png alt=logo> </a> TP Urbanisation des Syst√®mes d'Information </label> <div class=md-nav__source> <a href=https://github.com/INSATunisia/TP-Urbanisation/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> INSATunisia/TP-Urbanisation </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Travaux Pratiques Urbanisation des SI </a> </li> <li class=md-nav__item> <a href=../projet/ class=md-nav__link> Projet </a> </li> <li class=md-nav__item> <a href=../tp1/ class=md-nav__link> TP1 - Services Web SOAP avec Mule ESB </a> </li> <li class=md-nav__item> <a href=../tp2/ class=md-nav__link> TP2 - REST API Management avec Anypoint Studio </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#telecharger-pdf class=md-nav__link> T√©l√©charger PDF </a> </li> <li class=md-nav__item> <a href=#objectifs-du-tp class=md-nav__link> Objectifs du TP </a> </li> <li class=md-nav__item> <a href=#outils-et-versions class=md-nav__link> Outils et Versions </a> </li> <li class=md-nav__item> <a href=#camunda class=md-nav__link> Camunda </a> </li> <li class=md-nav__item> <a href=#bpmn-20 class=md-nav__link> BPMN 2.0 </a> </li> <li class=md-nav__item> <a href=#installation class=md-nav__link> Installation </a> </li> <li class=md-nav__item> <a href=#premier-projet-camunda-bpmn-helloworld class=md-nav__link> Premier Projet Camunda BPMN: Helloworld </a> <nav class=md-nav aria-label="Premier Projet Camunda BPMN: Helloworld"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#creation-du-projet-et-dependances class=md-nav__link> Cr√©ation du Projet et D√©pendances </a> </li> <li class=md-nav__item> <a href=#creation-de-la-classe-principale-pour-le-processus class=md-nav__link> Cr√©ation de la classe principale pour le processus </a> </li> <li class=md-nav__item> <a href=#modelisation-dun-processus-bpmn-20 class=md-nav__link> Mod√©lisation d'un processus BPMN 2.0 </a> </li> <li class=md-nav__item> <a href=#configuration-du-processus class=md-nav__link> Configuration du processus </a> </li> <li class=md-nav__item> <a href=#deploiement-du-processus class=md-nav__link> D√©ploiement du processus </a> </li> <li class=md-nav__item> <a href=#verification-du-deploiement-avec-cockpit class=md-nav__link> V√©rification du d√©ploiement avec Cockpit </a> </li> <li class=md-nav__item> <a href=#demarrage-du-processus class=md-nav__link> D√©marrage du processus </a> </li> <li class=md-nav__item> <a href=#configuration-des-permissions class=md-nav__link> Configuration des permissions </a> </li> <li class=md-nav__item> <a href=#creation-dun-formulaire-personnalise class=md-nav__link> Cr√©ation d'un formulaire personnalis√© </a> </li> <li class=md-nav__item> <a href=#ajout-dun-service-task-java class=md-nav__link> Ajout d'un Service Task Java </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#appel-dun-service-web-rest class=md-nav__link> Appel d'un Service Web REST </a> </li> <li class=md-nav__item> <a href=#homework class=md-nav__link> Homework </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/INSATunisia/TP-Urbanisation/edit/master/docs/tp3.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1>Tp3</h1> <p><img alt=Orchestration src=../img/orchestration.png></p> <h2 id=telecharger-pdf>T√©l√©charger PDF<a class=headerlink href=#telecharger-pdf title="Permanent link">&para;</a></h2> <p><a href=../tp3.pdf><img alt="Download TP3" src=../img/pdf.png></a></p> <h2 id=objectifs-du-tp>Objectifs du TP<a class=headerlink href=#objectifs-du-tp title="Permanent link">&para;</a></h2> <p>Cr√©ation d'un processus m√©tier (Business Process) en utilisant Camunda.</p> <h2 id=outils-et-versions>Outils et Versions<a class=headerlink href=#outils-et-versions title="Permanent link">&para;</a></h2> <ul> <li><a href=https://camunda.org/download/ >Camunda</a> - Distribution Tomcat, Version: 7.18.0</li> <li><a href=https://www.jetbrains.com/idea/download/ >IntelliJ IDEA</a> Version Ultimate 2016.1 (ou tout autre IDE de votre choix)</li> <li><a href=https://camunda.org/download/modeler/ >Camunda Modeler</a> Version 5.5.0</li> </ul> <h2 id=camunda>Camunda <a href=https://camunda.org><img alt="Camunda Website" src=../img/website.png></a><a class=headerlink href=#camunda title="Permanent link">&para;</a></h2> <p>Camunda est une plateforme open source pour la gestion des processus m√©tier. C'est un framework Java qui support <strong>BPMN</strong> pour l'automatisation des processus, <strong>CMMN</strong> pour le Case Management, et <strong>DMN</strong> pour le Business Decision Management.</p> <h2 id=bpmn-20>BPMN 2.0 <a href=http://www.bpmn.org/ ><img alt="BPMN Website" src=../img/website.png></a><a class=headerlink href=#bpmn-20 title="Permanent link">&para;</a></h2> <p>BPMN 2.0 (Business Process Modeling Notation) est un standard d√©velopp√© par le Object Management Group (<strong>OMG</strong>) pour fournir une notation facilement compr√©hensible par tous les utilisateurs m√©tier: les analystes m√©tier, les d√©veloppeurs impl√©mentant les technologies ex√©cutant ces processus et les personnes g√©rant et supervisant ces processus. BPMN permet d'√©tablir un pont minimisant le gap entre les conceptions des processus et leurs impl√©mentations.</p> <p>Dans sa premi√®re version, la sp√©cification BPMN permettait de fournir uniquement une notation graphique, et est devenue rapidement c√©l√®bre parmi les analystes m√©tier. Elle d√©finissait la mani√®re dont les concepts tels que les t√¢ches humaines et les scripts ex√©cutables, pouvaient √™tre visualis√©es de mani√®re standard, ind√©pendante d'un constructeur particulier.</p> <p>Cette deuxi√®me version √©tend ce standard en incluant des s√©mantiques d'ex√©cution et un format d'√©change commun. Ce qui veut dire que les mod√®les de processus BPMN 2.0 peuvent √™tre √©chang√©s entre des √©diteurs graphiques diff√©rents, et ex√©cut√©s sur n'importe quel moteur compatible avec BPMN 2.0, tel que Camunda et Activiti.</p> <h2 id=installation>Installation<a class=headerlink href=#installation title="Permanent link">&para;</a></h2> <p>Pour installer l'environnement n√©cessaire √† ce TP, il faut suivre les √©tapes suivantes:</p> <ul> <li>T√©l√©charger <a href=https://camunda.org/download/ >Camunda</a> distribution Tomcat (vous la trouverez en bas de la page), <a href=https://www.jetbrains.com/idea/download/ >IntelliJ IDEA</a> et <a href=https://camunda.org/download/modeler/ >Camunda Modeler</a>.</li> <li>D√©compresser le fichier .zip Camunda t√©l√©charg√©, et ex√©cuter <em>start-camunda.sh</em> (pour les syst√®mes Unix-based) ou <em>start-camunda.bat</em> (pour les syst√®mes Windows).</li> <li>La page d'accueil du serveur d'application va s'ouvrir dans votre navigateur pr√©f√©r√©.</li> <li>Lancer le Camunda Modeler.</li> </ul> <h2 id=premier-projet-camunda-bpmn-helloworld>Premier Projet Camunda BPMN: Helloworld<a class=headerlink href=#premier-projet-camunda-bpmn-helloworld title="Permanent link">&para;</a></h2> <h3 id=creation-du-projet-et-dependances>Cr√©ation du Projet et D√©pendances<a class=headerlink href=#creation-du-projet-et-dependances title="Permanent link">&para;</a></h3> <p>Vous allez maintenant cr√©er un nouveau projet Java pour d√©finir le comportement de votre processus.</p> <ul> <li>Ouvrir IntelliJ et cr√©er un nouveau projet Maven (sans archetype) intitul√© <em>HelloworldCamunda</em>.</li> <li> <p>Vous pouvez choisir les param√®tres suivants:</p> <ul> <li>Group Id: <em>tn.insat.eservices.tp3</em></li> <li>Artifact Id: <em>Helloworld</em></li> <li>Version: <em>1</em></li> </ul> </li> <li> <p>Dans le fichier <em>pom.xml</em>, indiquer que l'application sera d√©ploy√©e plus tard sous la forme d'un fichier <em>war</em>. Pour cela, ajouter la ligne suivante, juste apr√®s la version:</p> </li> </ul> <div class=highlight><pre><span></span><code><span class=nt>&lt;packaging&gt;</span>war<span class=nt>&lt;/packaging&gt;</span>
</code></pre></div> <ul> <li>Ajouter les d√©pendances n√©cessaires vers Camunda dans votre projet. Pour cela, ins√©rer les lignes suivantes dans votre fichier <em>pom.xml</em></li> </ul> <div class=highlight><pre><span></span><code><span class=nt>&lt;properties&gt;</span>
    <span class=nt>&lt;camunda.version&gt;</span>7.17.0<span class=nt>&lt;/camunda.version&gt;</span>
    <span class=nt>&lt;maven.compiler.source&gt;</span>1.8<span class=nt>&lt;/maven.compiler.source&gt;</span>
    <span class=nt>&lt;maven.compiler.target&gt;</span>1.8<span class=nt>&lt;/maven.compiler.target&gt;</span>
  <span class=nt>&lt;/properties&gt;</span>

  <span class=nt>&lt;dependencyManagement&gt;</span>
    <span class=nt>&lt;dependencies&gt;</span>
      <span class=nt>&lt;dependency&gt;</span>
        <span class=nt>&lt;groupId&gt;</span>org.camunda.bpm<span class=nt>&lt;/groupId&gt;</span>
        <span class=nt>&lt;artifactId&gt;</span>camunda-bom<span class=nt>&lt;/artifactId&gt;</span>
        <span class=nt>&lt;version&gt;</span>${camunda.version}<span class=nt>&lt;/version&gt;</span>
        <span class=nt>&lt;scope&gt;</span>import<span class=nt>&lt;/scope&gt;</span>
        <span class=nt>&lt;type&gt;</span>pom<span class=nt>&lt;/type&gt;</span>
      <span class=nt>&lt;/dependency&gt;</span>
    <span class=nt>&lt;/dependencies&gt;</span>
  <span class=nt>&lt;/dependencyManagement&gt;</span>

  <span class=nt>&lt;dependencies&gt;</span>
    <span class=nt>&lt;dependency&gt;</span>
      <span class=nt>&lt;groupId&gt;</span>org.camunda.bpm<span class=nt>&lt;/groupId&gt;</span>
      <span class=nt>&lt;artifactId&gt;</span>camunda-engine<span class=nt>&lt;/artifactId&gt;</span>
      <span class=nt>&lt;scope&gt;</span>provided<span class=nt>&lt;/scope&gt;</span>
    <span class=nt>&lt;/dependency&gt;</span>

    <span class=nt>&lt;dependency&gt;</span>
      <span class=nt>&lt;groupId&gt;</span>javax.servlet<span class=nt>&lt;/groupId&gt;</span>
      <span class=nt>&lt;artifactId&gt;</span>javax.servlet-api<span class=nt>&lt;/artifactId&gt;</span>
      <span class=nt>&lt;version&gt;</span>4.0.1<span class=nt>&lt;/version&gt;</span>
      <span class=nt>&lt;scope&gt;</span>provided<span class=nt>&lt;/scope&gt;</span>
    <span class=nt>&lt;/dependency&gt;</span>
  <span class=nt>&lt;/dependencies&gt;</span>

  <span class=nt>&lt;build&gt;</span>
    <span class=nt>&lt;plugins&gt;</span>
      <span class=nt>&lt;plugin&gt;</span>
        <span class=nt>&lt;groupId&gt;</span>org.apache.maven.plugins<span class=nt>&lt;/groupId&gt;</span>
        <span class=nt>&lt;artifactId&gt;</span>maven-war-plugin<span class=nt>&lt;/artifactId&gt;</span>
        <span class=nt>&lt;version&gt;</span>3.3.2<span class=nt>&lt;/version&gt;</span>
        <span class=nt>&lt;configuration&gt;</span>
          <span class=nt>&lt;failOnMissingWebXml&gt;</span>false<span class=nt>&lt;/failOnMissingWebXml&gt;</span>
        <span class=nt>&lt;/configuration&gt;</span>
      <span class=nt>&lt;/plugin&gt;</span>
    <span class=nt>&lt;/plugins&gt;</span>
  <span class=nt>&lt;/build&gt;</span>
</code></pre></div> <ul> <li>Faire un build de votre projet. Pour cela, cr√©er une nouvelle configuration de type Maven, que vous appellerez <em>maven-install</em> par exemple, et vous √©crirez dans la partie <strong>Command Line</strong> : <em>install</em>, comme suit:</li> </ul> <p><img alt="Maven Install" src=img/tp2/maven-install.png></p> <ul> <li>Lancer le build et v√©rifiez bien que vos packages ont bien √©t√© install√©s.</li> </ul> <h3 id=creation-de-la-classe-principale-pour-le-processus>Cr√©ation de la classe principale pour le processus<a class=headerlink href=#creation-de-la-classe-principale-pour-le-processus title="Permanent link">&para;</a></h3> <p>La prochaine √©tape permet de construire une classe pour le processus. Cette classe repr√©sente l'interface entre votre application et le moteur de processus Camunda.</p> <div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nn>tn.insat.eservices.tp3.helloworld</span><span class=p>;</span>

<span class=kn>import</span> <span class=nn>org.camunda.bpm.application.ProcessApplication</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>org.camunda.bpm.application.impl.ServletProcessApplication</span><span class=p>;</span>

<span class=nd>@ProcessApplication</span><span class=p>(</span><span class=s>&quot;Helloworld App&quot;</span><span class=p>)</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>HelloworldApplication</span> <span class=kd>extends</span> <span class=n>ServletProcessApplication</span> <span class=p>{</span>
    <span class=c1>// empty implementation</span>
<span class=p>}</span>
</code></pre></div> <p>Ajouter ensuite le fichier <em>processes.xml</em> sous le r√©pertoire <em>src/main/resources/META-INF</em>. Ce fichier nous permet de fournir une configuration pour le d√©ploiement de ce processus dans le moteur de processus.</p> <div class=highlight><pre><span></span><code><span class=cp>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class=nt>&lt;process-application</span>
        <span class=na>xmlns=</span><span class=s>&quot;http://www.camunda.org/schema/1.0/ProcessApplication&quot;</span>
        <span class=na>xmlns:xsi=</span><span class=s>&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class=nt>&gt;</span>

    <span class=nt>&lt;process-archive</span> <span class=na>name=</span><span class=s>&quot;helloworld&quot;</span><span class=nt>&gt;</span>
        <span class=nt>&lt;process-engine&gt;</span>default<span class=nt>&lt;/process-engine&gt;</span>
        <span class=nt>&lt;properties&gt;</span>
            <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&quot;isDeleteUponUndeploy&quot;</span><span class=nt>&gt;</span>false<span class=nt>&lt;/property&gt;</span>
            <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&quot;isScanForProcessDefinitions&quot;</span><span class=nt>&gt;</span>true<span class=nt>&lt;/property&gt;</span>
        <span class=nt>&lt;/properties&gt;</span>
    <span class=nt>&lt;/process-archive&gt;</span>

<span class=nt>&lt;/process-application&gt;</span>
</code></pre></div> <p>A partir de ce point, nous allons commencer √† mod√©liser le processus.</p> <h3 id=modelisation-dun-processus-bpmn-20>Mod√©lisation d'un processus BPMN 2.0<a class=headerlink href=#modelisation-dun-processus-bpmn-20 title="Permanent link">&para;</a></h3> <p>La mod√©lisation du processus se fera gr√¢ce au <em>Camunda Modeler</em>. Pour cela:</p> <ul> <li>D√©marrer l'application, et cr√©er un nouveau diagramme BPMN.</li> </ul> <div class="admonition warning"> <p class=admonition-title>Attention</p> <p>V√©rifiez bien que vous avez cr√©√© un diagramme Camunda Platform 7 (pas 8)</p> </div> <p><img alt="Premier Projet Camunda" src=img/tp2/camunda-first-proj.png></p> <ul> <li>Double-cliquer sur l'√©v√®nement de d√©part (le petit rond) pour modifier son nom. Nous l'appelerons <em>Dis Bonjour</em>.</li> <li>Cliquer sur l'√©v√®nement de d√©part, choisir le rectangle (repr√©sentant une activit√©) √† partir du menu contextuel qui appara√Æt, et le glisser vers un emplacement ad√©quat. Nous appellerons le nouvel √©v√®nement ins√©r√© <em>Ajouter Bonjour</em>.</li> </ul> <p><center><img src=../img/tp2/menu-contextuel.png width=200></center></p> <ul> <li>Cette t√¢che sera celle o√π l'utilisateur va indiquer son nom pour l'√©ternel <strong>Bonjour &lt;nom>!</strong>. Pour cela, nous devons indiquer que le traitement fait ici sera r√©alis√© par un humain. Pour cela, en cliquant sur l'activit√© cr√©√©e, cliquer dans le menu contextuel sur la clef √† molette, puis choisir <em>User Task</em>.</li> </ul> <p><center><img src=../img/tp2/user-task.png width=500></center></p> <ul> <li>Rajouter une t√¢che de fin au processus.</li> </ul> <h3 id=configuration-du-processus>Configuration du processus<a class=headerlink href=#configuration-du-processus title="Permanent link">&para;</a></h3> <ul> <li>Pour configurer la t√¢che utilisateur <em>Ajouter Bonjour</em>, cliquer dessus, et remplir le panneau des propri√©t√©s (sur la droite). D√©finir l'utilisateur auquel sera destin√©e cette activit√©. Pour cela, dans le champ <em>Assignee</em>, ins√©rer <em>john</em>. John est un utilisateur pr√©d√©fini sur le serveur Camunda. Plus tard, vous pourrez d√©finir votre propre liste d'utilisateurs et de r√¥les.</li> <li>Pour configurer le processus en entier, cliquer sur un endroit vide du canevas. Dans le panneau des propri√©t√©s, indiquer les champs suivants:<ul> <li>Id: <em>helloworld</em></li> <li>Name: <em>Helloworld</em></li> <li>Executable: <em>true</em></li> </ul> </li> </ul> <p>Nous obtenons pour finir le diagramme suivant:</p> <p><center><img src=../img/tp2/hw-process.png width=500></center></p> <ul> <li>Sauvegarder le diagramme sous le r√©pertoire <em>src/main/resources</em> du projet que vous avez cr√©√©. Vous l'appellerez <em>helloworld.bpmn</em></li> </ul> <h3 id=deploiement-du-processus>D√©ploiement du processus<a class=headerlink href=#deploiement-du-processus title="Permanent link">&para;</a></h3> <ul> <li>Ajouter la ligne suivante dans le fichier <em>processes.xml</em>:</li> </ul> <div class=highlight><pre><span></span><code>  <span class=nt>&lt;resource&gt;</span>helloworld.bpmn<span class=nt>&lt;/resource&gt;</span>
</code></pre></div> <ul> <li> <p>Configurer l'application pour qu'elle soit d√©ploy√©e sur le serveur tomcat int√©gr√© dans votre installation Camunda. Pour cela, dans IntelliJ:</p> <ul> <li>Aller au menu <em>File &gt; Project Structure...</em></li> <li>Cliquer sur <em>Artifacts</em>.</li> <li>D√©finir le type de l'archive √† d√©ployer: <em>Web Application: Archive</em></li> <li>D√©finir comme Output Directory le r√©pertoire <em>webapps</em>, se trouvant en g√©n√©ral sous le r√©pertoire <em>$CAMUNDA_HOME/server/apache-tomcat-<tomcatversion>/webapps</em>.</li> <li>Cliquer sur HelloworldCamunda-1.war. En bas de la fen√™tre, vous trouverez un bouton <em>Create Manifest</em>. Cliquer dessus, cela permettra de cr√©er le fichier Manifest responsable du d√©ploiement. Cr√©ez le dans le r√©pertoire <em>resources</em> du projet.</li> <li>Vous obtiendrez le r√©sultat suivant:</li> </ul> </li> </ul> <p><img alt="Configuration du d√©ploiement" src=img/tp2/deploy.png></p> <ul> <li>Aller au menu <em>Build &gt; Build Artifacts...</em> et cliquer sur <em>All Artifacts-&gt;Build</em>. Normalement, un nouveau fichier <em>HelloworldCamunda-1.war</em> sera cr√©√© dans le r√©pertoire <em>webapps</em> du serveur.</li> </ul> <h3 id=verification-du-deploiement-avec-cockpit>V√©rification du d√©ploiement avec Cockpit<a class=headerlink href=#verification-du-deploiement-avec-cockpit title="Permanent link">&para;</a></h3> <p>Camunda offre l'outil <em>Cockpit</em> pour inspecter les processus en cours d'ex√©cution et compl√©t√©s, et g√©rer les diff√©rents incidents. Pour cela, si votre serveur Camunda est bien lanc√©, vous pourrez visualiser vos processus dans le navigateur, en tapant: <code>http://localhost:8080/camunda/app/cockpit</code>. Identifiez-vous comme administrateur en tapant les credentials: <code>demo/demo</code>. Cliquer sur le nombre sous <em>Process Definitions</em> (cela devra √™tre <strong>3</strong> dans votre cas), vous devriez retrouver votre processus, avec un √©tat <em>checked</em>.</p> <p><img alt=Cockpit src=img/tp2/cockpit.png></p> <h3 id=demarrage-du-processus>D√©marrage du processus<a class=headerlink href=#demarrage-du-processus title="Permanent link">&para;</a></h3> <ul> <li>Aller au <em>Camunda Tasklist</em> (<code>http://localhost:8080/camunda/app/tasklist</code>), puis lancer le processus en cliquant sur le bouton <em>Start Process</em> (en haut √† droite).</li> <li>Cliquer sur votre processus <em>Helloworld</em>.</li> <li>Ajouter autant de variables que n√©cessaire dans le formulaire g√©n√©rique. Nous allons dans notre cas ajouter une variable <em>nom</em> de type cha√Æne de caract√®res. Pour cela, cliquer sur <em>Add a variable</em> et remplir comme suit (mettez votre nom bien s√ªr, pas le mien <img alt=üòÉ class=emojione src=https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/svg/1f603.svg title=:smiley:> ):</li> </ul> <p><img alt="Ajouter une variable" src=img/tp2/run-var.png></p> <ul> <li>En rafra√Æchissant maintenant le Cockpit, vous trouverez que le processus est pass√© √† l'√©tat <em>Running</em>.</li> </ul> <h3 id=configuration-des-permissions>Configuration des permissions<a class=headerlink href=#configuration-des-permissions title="Permanent link">&para;</a></h3> <p>Pour permettre √† l'utilisateur John de visualiser et lancer le processus <em>Helloworld</em>, il faudra lui rajouter les autorisations. Pour cela:</p> <ul> <li>Aller √† <em>Camunda Admin</em> (<code>http://localhost:8080/camunda/app/admin/default/#/authorization?resource=0</code>).</li> <li>Ajouter une nouvelle autorisation dans la partie <em>Process Definition</em>, pour permettre √† John de manipuler la d√©finition du processus <em>Helloworld</em>.</li> </ul> <p><img alt="Ajouter une permission - Process Definition" src=img/tp2/def-perm.png></p> <ul> <li>Dans la partie <em>Process Instance</em>, ajouter la permission de cr√©er une instance de processus √† John.</li> </ul> <p><img alt="Ajouter une permission - Process Instance" src=img/tp2/inst-perm.png></p> <ul> <li>Vous authentifier comme √©tant John, en utilisant (<em>john/john</em>), de pr√©f√©rence sur un autre navigateur. Vous pourrez ainsi visualiser le processus Helloworld, tel qu'il est visible par John. Il pourra ainsi ajouter les variables de son choix, et compl√©ter le processus.</li> </ul> <p><img alt="Ex√©cuter le processus" src=img/tp2/john-run-process.png></p> <h3 id=creation-dun-formulaire-personnalise>Cr√©ation d'un formulaire personnalis√©<a class=headerlink href=#creation-dun-formulaire-personnalise title="Permanent link">&para;</a></h3> <p>Pour cr√©er votre propre formulaire, avec des variables en entr√©e qui peuvent √™tre manipul√©es par le service, suivre les √©tapes suivantes:</p> <ul> <li>Revenir vers IntelliJ, et cr√©er un fichier <em>dis-bonjour.html</em> sous le r√©pertoire <em>src/main/webapp/forms</em>. Ajouter le contenu suivant:</li> </ul> <div class=highlight><pre><span></span><code><span class=p>&lt;</span><span class=nt>form</span> <span class=na>name</span><span class=o>=</span><span class=s>&quot;disBonjour&quot;</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&quot;form-group&quot;</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&quot;nom&quot;</span><span class=p>&gt;</span>Nom<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>class</span><span class=o>=</span><span class=s>&quot;form-control&quot;</span>
               <span class=na>cam-variable-type</span><span class=o>=</span><span class=s>&quot;String&quot;</span>
               <span class=na>cam-variable-name</span><span class=o>=</span><span class=s>&quot;nom&quot;</span>
               <span class=na>name</span><span class=o>=</span><span class=s>&quot;nom&quot;</span> <span class=p>/&gt;</span>
    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</code></pre></div> <ul> <li>Ouvrir le processus avec le Modeler, et cliquer sur l'√©v√®nement de d√©part. Dans le panneau des propri√©t√©s, choisir la tabulation <em>Forms</em>, choisir le type <em>Embedded or External Task Forms</em> et ins√©rer <code>embedded:app:forms/dis-bonjour.html</code> dans le champ <em>Key</em>. Cela indique que nous voulons utiliser un formulaire int√©gr√© dans la Tasklist, et qu'il sera charg√© √† partir de l'application.</li> <li>Sauvegarder, et rafra√Æchir le projet dans IntelliJ.</li> <li>De m√™me, nous allons cr√©er le formulaire qui va permettre √† John de dire Bonjour. On l'appellera <em>bonjour.html</em>.</li> </ul> <div class=highlight><pre><span></span><code><span class=p>&lt;</span><span class=nt>form</span> <span class=na>name</span><span class=o>=</span><span class=s>&quot;bonjour&quot;</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&quot;form-group&quot;</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&quot;salutation&quot;</span><span class=p>&gt;</span>Salutation<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>class</span><span class=o>=</span><span class=s>&quot;form-control&quot;</span>
               <span class=na>cam-variable-type</span><span class=o>=</span><span class=s>&quot;String&quot;</span>
               <span class=na>cam-variable-name</span><span class=o>=</span><span class=s>&quot;salutation&quot;</span>
               <span class=na>name</span><span class=o>=</span><span class=s>&quot;salutation&quot;</span> <span class=p>/&gt;</span>
    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&quot;form-group&quot;</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&quot;nom&quot;</span><span class=p>&gt;</span>Nom<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>class</span><span class=o>=</span><span class=s>&quot;form-control&quot;</span>
               <span class=na>cam-variable-type</span><span class=o>=</span><span class=s>&quot;String&quot;</span>
               <span class=na>cam-variable-name</span><span class=o>=</span><span class=s>&quot;nom&quot;</span>
               <span class=na>name</span><span class=o>=</span><span class=s>&quot;nom&quot;</span>
               <span class=na>readonly</span><span class=o>=</span><span class=s>&quot;true&quot;</span> <span class=p>/&gt;</span>
    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</code></pre></div> <ul> <li>Affecter ce formulaire √† la t√¢che <em>Ajouter Bonjour</em> de la m√™me mani√®re que pr√©c√©demment.</li> <li>Sauvegarder tout et re-d√©ployer le projet.</li> <li>Lancer maintenant le processus. Saisir votre nom dans la rubrique <em>Nom</em>.</li> </ul> <p><img alt="Ex√©cuter le processus2" src=img/tp2/start-process-2.png></p> <ul> <li>Identifiez-vous comme John de nouveau, vous trouverez le deuxi√®me formulaire:</li> </ul> <p><img alt="Ajouter Bonjour!" src=img/tp2/add-hello-2.png></p> <p>Pour l'instant, en cliquant sur compl√©ter, rien ne se passe, car nous n'avons indiqu√© nulle part ce qui doit √™tre r√©alis√© suite √† la saisie du "Bonjour" par John. Cela sera fait gr√¢ce √† un <em>Service Task</em>.</p> <h3 id=ajout-dun-service-task-java>Ajout d'un Service Task Java<a class=headerlink href=#ajout-dun-service-task-java title="Permanent link">&para;</a></h3> <p>Pour d√©finir le comportement √† faire de votre service, suivre les √©tapes suivantes:</p> <ul> <li>Utiliser le Modeler pour ajouter un service task juste apr√®s le user task. Pour cela, s√©lectionner une activit√© dans la palette de gauche, et la glisser entre la t√¢che utilisateur et l'√©v√®nement de fin. Avec la clef √† molette <img alt=clef-molette src=img/tp2/clef-molette.png> , s√©lectionner l'option <em>Service Task</em>. Appeler le service <em>Dire Bonjour</em>. Vous obtiendrez le r√©sultat suivant:</li> </ul> <p><img alt="Nouveau Processus avec Service Task" src=img/tp2/service-task.png></p> <ul> <li>Ajouter maintenant l'impl√©mentation du Service Task. Pour cela, ajouter une classe dans le projet IntelliJ appel√©e <em>ProcessRequestDelegate</em> qui impl√©mente l'interface <em>JavaDelegate</em>, comme suit:</li> </ul> <div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nn>tn.insat.eservices.tp3.helloworld</span><span class=p>;</span>

<span class=kn>import</span> <span class=nn>java.util.logging.Logger</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>org.camunda.bpm.engine.delegate.DelegateExecution</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>org.camunda.bpm.engine.delegate.JavaDelegate</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>ProcessRequestDelegate</span> <span class=kd>implements</span> <span class=n>JavaDelegate</span> <span class=p>{</span>

    <span class=kd>private</span> <span class=kd>final</span> <span class=kd>static</span> <span class=n>Logger</span> <span class=n>LOGGER</span> <span class=o>=</span> <span class=n>Logger</span><span class=p>.</span><span class=na>getLogger</span><span class=p>(</span><span class=s>&quot;Hello-Greetings&quot;</span><span class=p>);</span>

    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>execute</span><span class=p>(</span><span class=n>DelegateExecution</span> <span class=n>execution</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
        <span class=n>LOGGER</span><span class=p>.</span><span class=na>info</span><span class=p>(</span><span class=s>&quot;Hey! &quot;</span> <span class=o>+</span> <span class=n>execution</span><span class=p>.</span><span class=na>getVariable</span><span class=p>(</span><span class=s>&quot;salutation&quot;</span><span class=p>)</span>
                    <span class=o>+</span> <span class=s>&quot; &quot;</span> <span class=o>+</span> <span class=n>execution</span><span class=p>.</span><span class=na>getVariable</span><span class=p>(</span><span class=s>&quot;nom&quot;</span><span class=p>)</span> <span class=o>+</span> <span class=s>&quot;!&quot;</span><span class=p>);</span>
    <span class=p>}</span>

<span class=p>}</span>
</code></pre></div> <ul> <li>Dans le Modeler, utiliser le panneau des propri√©t√©s pour r√©f√©rencer la classe dans le processus. Pour cela, cliquer sur le Service Task, et d√©finir son impl√©mentation par la Java Class: <code>tn.insat.eservices.tp3.helloworld.ProcessRequestDelegate</code>.</li> <li>D√©ployer votre application, et observer le r√©sultat. Il sera affich√© dans le log de votre serveur Tomcat (catalina.out), comme suit:</li> </ul> <p><img alt="Bonjour Lilia!" src=img/tp2/bonjour.png></p> <h2 id=appel-dun-service-web-rest>Appel d'un Service Web REST<a class=headerlink href=#appel-dun-service-web-rest title="Permanent link">&para;</a></h2> <p>Gr√¢ce aux connecteurs, Camunda peut int√©grer des services web REST ou SOAP. Pour cela, nous allons faire appel √† un service web classique de m√©t√©o. Dans son formulaire, John va saisir le nom d'une ville, et le processus devra retourner la temp√©rature actuelle dans cette ville, en plus de l'usuel Bonjour.</p> <ul> <li>Commencer par ajuster le formulaire <em>bonjour.html</em>, en lui ajoutant un autre champs de texte: <em>ville</em> apr√®s le champs <em>nom</em>.</li> <li>Revenir dans le Modeler, et ajouter un Service Task, qu'on appellera <em>Consulter M√©t√©o</em>, entre <em>Ajouter Bonjour</em> et <em>Dire Bonjour</em>.</li> <li>Dans ce service, indiquer que le type d'impl√©mentation est <em>Connector</em>, et vous d√©placer vers l'onglet <em>Connector</em> pour le configurer.</li> <li> <p>Donner les param√®tres suivants √† votre connecteur;</p> <ul> <li><strong>Id</strong>: <em>http-connector</em></li> <li><strong>Connector Input</strong>: Les input prendront toutes les informations n√©cessaires pour envoyer la requ√™te REST au service web <em>OpenWeatherMap</em>. Ce service prend en param√®tre la ville, qui sera ins√©r√©e dans notre cas √† partir du formulaire pr√©c√©dent, dans le champs <em>ville</em>.</li> </ul> <table> <thead> <tr> <th>Nom</th> <th>Type</th> <th>Valeur</th> </tr> </thead> <tbody> <tr> <td>url</td> <td>Script / JavaScript / Inline Script</td> <td><code>var ville=execution.getVariable("ville"); 'http://api.openweathermap.org/data/2.5/weather?APPID=17db59488cadcad345211c36304a9266&amp;q='+ville;</code></td> </tr> <tr> <td>method</td> <td>String or Expression</td> <td>GET</td> </tr> <tr> <td>headers</td> <td>Map</td> <td><code>key: accept, value:application/json - key:content-type, value:application/json</code></td> </tr> </tbody> </table> <ul> <li><strong>Connector Output</strong>: Le service utilis√© renvoie un document json qui ressemble √† ce qui suit:</li> </ul> </li> </ul> <div class=highlight><pre><span></span><code><span class=p>{</span>
  <span class=nx>coord</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>lon</span><span class=o>:</span> <span class=mf>10.17</span><span class=p>,</span>
    <span class=nx>lat</span><span class=o>:</span> <span class=mf>36.82</span>
  <span class=p>},</span>
  <span class=nx>weather</span><span class=o>:</span> <span class=p>[</span>
    <span class=p>{</span>
      <span class=nx>id</span><span class=o>:</span> <span class=mf>801</span><span class=p>,</span>
      <span class=nx>main</span><span class=o>:</span> <span class=s2>&quot;Clouds&quot;</span><span class=p>,</span>
      <span class=nx>description</span><span class=o>:</span> <span class=s2>&quot;few clouds&quot;</span><span class=p>,</span>
      <span class=nx>icon</span><span class=o>:</span> <span class=s2>&quot;02d&quot;</span>
    <span class=p>}</span>
  <span class=p>],</span>
  <span class=nx>base</span><span class=o>:</span> <span class=s2>&quot;stations&quot;</span><span class=p>,</span>
  <span class=nx>main</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>temp</span><span class=o>:</span> <span class=mf>299.87</span><span class=p>,</span>
    <span class=nx>pressure</span><span class=o>:</span> <span class=mf>1018</span><span class=p>,</span>
    <span class=nx>humidity</span><span class=o>:</span> <span class=mf>39</span><span class=p>,</span>
    <span class=nx>temp_min</span><span class=o>:</span> <span class=mf>299.15</span><span class=p>,</span>
    <span class=nx>temp_max</span><span class=o>:</span> <span class=mf>301.15</span>
  <span class=p>},</span>
  <span class=nx>visibility</span><span class=o>:</span> <span class=mf>10000</span><span class=p>,</span>
  <span class=nx>wind</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>speed</span><span class=o>:</span> <span class=mf>3.6</span><span class=p>,</span>
    <span class=nx>deg</span><span class=o>:</span> <span class=mf>40</span>
  <span class=p>},</span>
  <span class=nx>clouds</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>all</span><span class=o>:</span> <span class=mf>20</span>
  <span class=p>},</span>
  <span class=nx>dt</span><span class=o>:</span> <span class=mf>1506864600</span><span class=p>,</span>
  <span class=nx>sys</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>type</span><span class=o>:</span> <span class=mf>1</span><span class=p>,</span>
    <span class=nx>id</span><span class=o>:</span> <span class=mf>6318</span><span class=p>,</span>
    <span class=nx>message</span><span class=o>:</span> <span class=mf>0.0039</span><span class=p>,</span>
    <span class=nx>country</span><span class=o>:</span> <span class=s2>&quot;TN&quot;</span><span class=p>,</span>
    <span class=nx>sunrise</span><span class=o>:</span> <span class=mf>1506834907</span><span class=p>,</span>
    <span class=nx>sunset</span><span class=o>:</span> <span class=mf>1506877308</span>
  <span class=p>},</span>
  <span class=nx>id</span><span class=o>:</span> <span class=mf>2464470</span><span class=p>,</span>
  <span class=nx>name</span><span class=o>:</span> <span class=s2>&quot;Tunis&quot;</span><span class=p>,</span>
  <span class=nx>cod</span><span class=o>:</span> <span class=mf>200</span>
<span class=p>}</span>
</code></pre></div> <p>Si l'objectif est de retourner la valeur de la temp√©rature, on doit naviguer vers l'√©l√©ment <em>main</em> puis √† son fils <em>temp</em>. L'output de notre service aura donc la forme suivante:</p> <table> <thead> <tr> <th>Nom</th> <th>Type</th> <th>Valeur</th> </tr> </thead> <tbody> <tr> <td>WsResponse</td> <td>Script / JavaScript / Inline Script</td> <td><code>S(response).prop("main").prop("temp").numberValue();</code></td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>Toujours tester votre web service REST sur navigateur avant de l'utiliser dans une quelconque application!</p> </div> <ul> <li>Maintenant, ajouter le code d'exploitation de ce service dans la classe <em>ProcessRequestDelegate</em>, pour lui indiquer d'afficher le r√©sultat de la requ√™te:</li> </ul> <div class=highlight><pre><span></span><code><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ProcessRequestDelegate</span> <span class=kd>implements</span> <span class=n>JavaDelegate</span> <span class=p>{</span>

    <span class=kd>private</span> <span class=kd>final</span> <span class=kd>static</span> <span class=n>Logger</span> <span class=n>LOGGER</span> <span class=o>=</span> <span class=n>Logger</span><span class=p>.</span><span class=na>getLogger</span><span class=p>(</span><span class=s>&quot;Hello-Greetings&quot;</span><span class=p>);</span>

    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>execute</span><span class=p>(</span><span class=n>DelegateExecution</span> <span class=n>execution</span><span class=p>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=p>{</span>
        <span class=n>LOGGER</span><span class=p>.</span><span class=na>info</span><span class=p>(</span><span class=s>&quot;Hey! &quot;</span> <span class=o>+</span> <span class=n>execution</span><span class=p>.</span><span class=na>getVariable</span><span class=p>(</span><span class=s>&quot;salutation&quot;</span><span class=p>)</span> <span class=o>+</span> <span class=s>&quot; &quot;</span>
                <span class=o>+</span> <span class=n>execution</span><span class=p>.</span><span class=na>getVariable</span><span class=p>(</span><span class=s>&quot;nom&quot;</span><span class=p>)</span>
                <span class=o>+</span> <span class=s>&quot;! La temp√©rature aujourd&#39;hui √† &quot;</span>
                <span class=o>+</span> <span class=n>execution</span><span class=p>.</span><span class=na>getVariable</span><span class=p>(</span><span class=s>&quot;ville&quot;</span><span class=p>)</span>
                <span class=o>+</span> <span class=s>&quot; est de &quot;</span>
                <span class=o>+</span> <span class=n>execution</span><span class=p>.</span><span class=na>getVariable</span><span class=p>(</span><span class=s>&quot;WsResponse&quot;</span><span class=p>)</span><span class=o>+</span><span class=s>&quot;!&quot;</span><span class=p>);</span>
    <span class=p>}</span>

<span class=p>}</span>
</code></pre></div> <ul> <li> <p>Tout sauvegarder puis d√©ployer le service. En l'ex√©cutant, vous obtenez le r√©sultat suivant:</p> <ul> <li> <p>L'utilisateur demo saisit son nom: <img alt="Saisie du nom" src=img/tp2/start-process-2.png></p> </li> <li> <p>L'utilisateur john rajoute la salutation et la ville: <img alt="Ajout du nom et de la ville" src=img/tp2/say-hello-3.png></p> </li> <li> <p>Le processus affiche ce r√©sultat sur le log: <img alt=R√©sultat src=img/tp2/resultat-3.png></p> </li> </ul> </li> </ul> <h2 id=homework>Homework<a class=headerlink href=#homework title="Permanent link">&para;</a></h2> <div class="admonition note"> <p class=admonition-title>Projet E3</p> <p>Pour la s√©ance de TP prochaine, vous devez r√©aliser l'√©tape 3 du projet, qui consiste √†:</p> <ul> <li>Concevoir et impl√©menter les processus m√©tiers choisis de votre entreprise, avec Camunda ou tout autre outil BPM de votre choix.</li> <li>Commencer l'impl√©mentation et configuration de votre ESB, pour permettre la communication entre les services, processus m√©tiers et clients. </li> </ul> </div> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2022-11-15T10:01:49+01:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2022-11-15</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 Lilia Sfaxi </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.092fa1f6.min.js"}</script> <script src=../assets/javascripts/bundle.e3b2bf44.min.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> </body> </html>